<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="jakarta.faces.html" xmlns:p="http://primefaces.org/ui"
    xmlns:f="jakarta.faces.core" xmlns:ui="jakarta.faces.facelets" template="/WEB-INF/template.xhtml">

    <ui:define name="content">
        <h1 style="margin-bottom: 5px;">
            <i class="pi pi-building" style="color: #6366f1;"></i> Catálogo de Proveedores
        </h1>
        <p style="color: #666; margin-top: 0;">Gestión de proveedores del sistema</p>

        <h:form id="formRegistro">
            <p:panel header="#{proveedorBean.proveedor.id ne null ? 'Editar Proveedor' : 'Nuevo Proveedor'}"
                styleClass="shadow-2" style="margin-bottom: 20px;">

                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                    <div class="p-field">
                        <label style="font-weight: 500; display: block; margin-bottom: 5px;">RUC *</label>
                        <p:inputText id="ruc" value="#{proveedorBean.proveedor.ruc}" required="true" maxlength="11"
                            style="width: 100%;" placeholder="20100000001" />
                    </div>

                    <div class="p-field" style="grid-column: span 2;">
                        <label style="font-weight: 500; display: block; margin-bottom: 5px;">Razón Social *</label>
                        <p:inputText id="razon" value="#{proveedorBean.proveedor.razonSocial}" required="true"
                            style="width: 100%;" placeholder="Nombre de la empresa" />
                    </div>

                    <div class="p-field" style="grid-column: span 2;">
                        <label style="font-weight: 500; display: block; margin-bottom: 5px;">Dirección</label>
                        <p:inputText id="dir" value="#{proveedorBean.proveedor.direccion}" style="width: 100%;"
                            placeholder="Av. Principal 123, Lima" />
                    </div>

                    <div class="p-field">
                        <label style="font-weight: 500; display: block; margin-bottom: 5px;">Teléfono</label>
                        <p:inputText id="tel" value="#{proveedorBean.proveedor.telefono}" style="width: 100%;"
                            placeholder="01-1234567" />
                    </div>

                    <div class="p-field">
                        <label style="font-weight: 500; display: block; margin-bottom: 5px;">Contacto</label>
                        <p:inputText value="#{proveedorBean.proveedor.contacto}" style="width: 100%;"
                            placeholder="Nombre del contacto" />
                    </div>

                    <div class="p-field">
                        <label style="font-weight: 500; display: block; margin-bottom: 5px;">Correo</label>
                        <p:inputText value="#{proveedorBean.proveedor.correo}" style="width: 100%;"
                            placeholder="ventas@empresa.com" />
                    </div>

                    <div class="p-field">
                        <label style="font-weight: 500; display: block; margin-bottom: 5px;">Cuenta Bancaria</label>
                        <p:inputText value="#{proveedorBean.proveedor.cuentaBancaria}" style="width: 100%;"
                            placeholder="Banco - Nro. Cuenta" />
                    </div>

                    <div class="p-field">
                        <label style="font-weight: 500; display: block; margin-bottom: 5px;">Estado</label>
                        <p:selectOneMenu value="#{proveedorBean.proveedor.estado}" style="width: 100%;">
                            <f:selectItem itemLabel="Activo" itemValue="Activo" />
                            <f:selectItem itemLabel="Inactivo" itemValue="Inactivo" />
                        </p:selectOneMenu>
                    </div>
                </div>

                <div style="text-align: right; margin-top: 15px; padding-top: 15px; border-top: 1px solid #e5e7eb;">
                    <p:commandButton value="Limpiar" icon="pi pi-refresh" actionListener="#{proveedorBean.nuevo}"
                        update=":formRegistro" styleClass="ui-button-secondary" style="margin-right: 10px;" />
                    <p:commandButton value="Guardar" icon="pi pi-save" actionListener="#{proveedorBean.guardar}"
                        update=":formTabla:tablaProveedores :formRegistro :msgs" styleClass="ui-button-success" />
                </div>
            </p:panel>
        </h:form>

        <h:form id="formTabla">
            <p:dataTable id="tablaProveedores" value="#{proveedorBean.proveedores}" var="pv" stripedRows="true"
                paginator="true" rows="10" styleClass="shadow-2" emptyMessage="No hay proveedores registrados">

                <f:facet name="header">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span>Proveedores Registrados</span>
                        <p:badge value="#{proveedorBean.proveedores.size()}" severity="info" />
                    </div>
                </f:facet>

                <p:column headerText="RUC" style="width: 110px;">
                    <h:outputText value="#{pv.ruc}" style="font-family: monospace;" />
                </p:column>

                <p:column headerText="Razón Social" sortBy="#{pv.razonSocial}">
                    <h:outputText value="#{pv.razonSocial}" style="font-weight: 500;" />
                </p:column>

                <p:column headerText="Dirección">
                    <h:outputText value="#{pv.direccion}" />
                </p:column>

                <p:column headerText="Contacto" style="width: 150px;">
                    <h:outputText value="#{pv.contacto}" /><br />
                    <small style="color: #666;">#{pv.telefono}</small>
                </p:column>

                <p:column headerText="Cuenta Bancaria" style="width: 180px;">
                    <h:outputText value="#{pv.cuentaBancaria}" rendered="#{not empty pv.cuentaBancaria}" />
                    <span style="color: #999;" rendered="#{empty pv.cuentaBancaria}">-</span>
                </p:column>

                <p:column headerText="Estado" style="width: 90px; text-align: center;">
                    <p:badge value="#{pv.estado}" severity="#{pv.estado eq 'Activo' ? 'success' : 'danger'}" />
                </p:column>

                <p:column headerText="Acciones" style="width: 100px; text-align: center;">
                    <p:commandButton icon="pi pi-pencil" styleClass="ui-button-sm"
                        actionListener="#{proveedorBean.seleccionar(pv)}" update=":formRegistro" title="Editar"
                        style="margin-right: 5px;" />
                    <p:commandButton icon="pi pi-trash" styleClass="ui-button-danger ui-button-sm"
                        actionListener="#{proveedorBean.eliminar(pv)}" update="tablaProveedores :msgs" title="Eliminar">
                        <p:confirm header="Confirmar" message="¿Eliminar el proveedor #{pv.razonSocial}?"
                            icon="pi pi-exclamation-triangle" />
                    </p:commandButton>
                </p:column>
            </p:dataTable>

            <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                <p:commandButton value="Sí" type="button" styleClass="ui-confirmdialog-yes ui-button-danger"
                    icon="pi pi-check" />
                <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no ui-button-secondary"
                    icon="pi pi-times" />
            </p:confirmDialog>
        </h:form>

        <style>
            .shadow-2 {
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            }
        </style>
    </ui:define>
</ui:composition>